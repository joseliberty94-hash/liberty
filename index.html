<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>CRM Liberty</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: #f4f6f9;
  display: flex;
}

/* SIDEBAR */
.sidebar {
  width: 230px;
  background: #0f172a;
  color: white;
  height: 100vh;
  padding: 20px;
}
.sidebar h2 { text-align: center; margin-bottom: 30px; }
.sidebar a {
  display: block;
  padding: 12px;
  color: white;
  text-decoration: none;
  border-radius: 8px;
  margin-bottom: 10px;
}
.sidebar a:hover { background: #1e293b; }

/* MAIN */
.main {
  flex: 1;
  padding: 25px;
  overflow-y: auto;
}

.card {
  background: white;
  padding: 20px;
  border-radius: 14px;
  box-shadow: 0 0 10px rgba(0,0,0,.1);
  margin-bottom: 20px;
}
h2 { margin-top: 0; }

input, select, textarea, button {
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin: 5px 0;
  width: 100%;
}
button {
  background: #2563eb;
  color: white;
  border: none;
  cursor: pointer;
}
button:hover {
  background: #1d4ed8;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  padding: 10px;
  border-bottom: 1px solid #ddd;
  text-align: center;
}
th { background: #e5e7eb; }

</style>
</head>

<body>

<div class="sidebar">
  <h2>CRM Liberty</h2>
  <a href="#"> CRM Comercial</a>
  <a href="#"> Liberty Statistic</a>
</div>

<div class="main">

  <!-- AGREGAR AGENCIA -->
  <div class="card">
    <h2>Registrar Agencia</h2>
    <input type="text" id="agenciaNombre" placeholder="Nombre de Agencia">
    <button onclick="guardarAgencia()">Guardar Agencia</button>
  </div>

  <!-- AGREGAR ACCIN -->
  <div class="card">
    <h2>Registrar Acci贸n Comercial</h2>
    <input type="text" id="cliente" placeholder="Cliente">
    <select id="agenciaSelect"><option value="">Seleccione Agencia</option></select>
    <input type="text" id="vendedor" placeholder="Vendedor">
    <input type="text" id="tipoAccion" placeholder="Tipo de acci贸n">
    <input type="date" id="fecha">
    <textarea id="observaciones" placeholder="Observaciones"></textarea>
    <button onclick="guardarAccion()">Guardar Acci贸n</button>
  </div>

  <!-- TABLA -->
  <div class="card">
    <h2>Acciones Registradas</h2>
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Agencia</th>
          <th>Vendedor</th>
          <th>Tipo</th>
          <th>Observaci贸n</th>
        </tr>
      </thead>
      <tbody id="tablaAcciones"></tbody>
    </table>
  </div>

</div>

<script>
let agencias = [];
let acciones = [];

function guardarAgencia(){
  const nombre = document.getElementById("agenciaNombre").value.trim();
  if(!nombre) return alert("Ingrese nombre de agencia");
  agencias.push(nombre);
  actualizarAgencias();
  document.getElementById("agenciaNombre").value = "";
}

function actualizarAgencias(){
  const select = document.getElementById("agenciaSelect");
  select.innerHTML = '<option value="">Seleccione Agencia</option>';
  agencias.forEach(a => {
    let op = document.createElement("option");
    op.value = a;
    op.text = a;
    select.add(op);
  });
}

function guardarAccion(){
  const vFecha = document.getElementById("fecha").value;
  const vAgencia = document.getElementById("agenciaSelect").value;
  const vVendedor = document.getElementById("vendedor").value;
  const vTipo = document.getElementById("tipoAccion").value;
  const vObs = document.getElementById("observaciones").value;

  if(!vFecha || !vAgencia || !vVendedor || !vTipo){
    return alert("Complete todos los campos obligatorios");
  }

  const nuevaAccion = {
    fecha: vFecha,
    agencia: vAgencia,
    vendedor: vVendedor,
    tipoAccion: vTipo,
    observacion: vObs
  };

  // Enviar a tu Google Sheet
  fetch("https://script.google.com/macros/s/AKfycbzhpio0y8ZwHZppVJ6-lWB8FjrzJUhvBlFGFwncfVC6COIROBl3dQyLxG7QFP9zKDDjVQ/exec", {
    method: "POST",
    body: JSON.stringify(nuevaAccion)
  })
  .then(res => res.json())
  .then(resp => {
    alert("Acci贸n guardada en Google Sheet!");
    acciones.push(nuevaAccion);
    mostrarAcciones();
    // Limpiar form
    document.getElementById("cliente").value = "";
    document.getElementById("vendedor").value = "";
    document.getElementById("tipoAccion").value = "";
    document.getElementById("fecha").value = "";
    document.getElementById("observaciones").value = "";
  })
  .catch(err => {
    console.error(err);
    alert("Error guardando la acci贸n");
  });
}

function mostrarAcciones(){
  const tabla = document.getElementById("tablaAcciones");
  tabla.innerHTML = "";
  acciones.forEach(a => {
    tabla.innerHTML += `
      <tr>
        <td>${a.fecha}</td>
        <td>${a.agencia}</td>
        <td>${a.vendedor}</td>
        <td>${a.tipoAccion}</td>
        <td>${a.observacion}</td>
      </tr>`;
  });
}

</script>

</body>
</html>
